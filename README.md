# course-db-01

# Схема
![Схема базы](sb_schema.png)

# Документация
**manufacturer** -
Производитель продукта, изготавливает продукты.

**supplier** - Поставщик продукта, поставляет продукты разных поставщиков по своей цене.

**product_category** - Категория производимого продукта.

**product** - Продукт, имеет конкретную категорию и производителя, может поставляться разными поставщиками.

**price** -Цена продукта, зависит от поставщика, который предоставляет данный продукт.

**customer** - Покупатель, может совершать покупки в магазине.

**purchase** - Покупка, совершается покупателем и может включать одну или несколько единиц продукта.

**purchase_item** - Единица продукта в покупке по цене одного из поставщиков.

#Запросы, индексы, ограничения

##Запросы

- Поиск поставщика с минимальной и максимальной ценой продукта
- Поиск продукта с поставщиками больше определенного количества
- Поиск категорий товаров с наибольшим и наименьшим количеством продаж, наибольшей и наименьшей общей суммой в заказах
- Поиск покупателей с товарами определенной категории, покупателей с наибольшими тратами
- Расчет средней суммы и размера заказа

##Дополнительные индексы, кардинальность

###Для начала связываем таблицы по внешнему ключу:

**purchase.customer_id FK customer.id**

**purchase_item.purchase_id FK purchase_id**

**purchase_item.price_id FK price.id**

**price.product_id FK product.id**

**price.supplier_id FK supplier.id**

**product.product_category_id FK product_category.id**

**product.manufacturer_id FK manufacturer_id**

###Добавляем уникальные индексы для:

**customer.email, customer.phone** - допускаем поиск пользователя по почте и телефону

**manufacturer.title**

**supplier.title**

**product.title**

**product_category.title**

***.title** - заголовки характеризуют сущность и выводятся пользователям, для избежания путаницы не допускаем дубликатов имен

###Кардинальность оцениваем только для индексируемых полей, для остальных - по необходимости индексировать

**purchase.customer_id** - высокая (предполагаем отсутсвие заказчиков юр лиц) 

**purchase_item.purchase_id** - высокая (заказчик не купит тысячи позиций разом)

**purchase_item.price_id** - низкая (разные заказчики покупают те же товары)

**price.product_id** - высокая (не ожидаем тысяч цен поставщиков одного товара)

**price.supplier_id** - высокая (не ожидаем тысяч поставщиков одного товара)

**product.product_category_id** - низкая (много товаров одной категории)

**product.manufacturer_id** - низкая (много продуктов одного производителя)

###Логические ограничения

**customer.phone, customer.email** - соответствуют шаблону

**price.value** - цена должна быть больше нуля